import{b as B,j as D}from"./chunk-UEYM3AXK.js";import{a as E,b as C,c as T,d as P,e as S,g as j,i as R,l as z,p as L,q as G,s as q}from"./chunk-LNDCD6JT.js";import{A as c,Ba as p,Ca as v,E as m,G as _,H as d,Ia as l,N as f,O as h,P as g,Pa as A,Qa as b,U as k,aa as s,eb as V,ka as y,ma as u,qa as M,qb as F,rb as N,ua as n,va as r,wa as a,xb as x,za as w}from"./chunk-X2AQS727.js";var $=()=>["/"],H=()=>[""];function K(t,U){if(t&1){let i=w();g(),n(0,"svg",19),p("click",function(){f(i);let o=v();return h(o.togglePasswordVisibility())}),a(1,"path",20),r()}}function Q(t,U){if(t&1){let i=w();g(),n(0,"svg",21),p("click",function(){f(i);let o=v();return h(o.togglePasswordVisibility())}),a(1,"path",22),r()}}var O=(()=>{class t{constructor(){this.authService=m(B),this.toastrService=m(D),this.formBuilder=m(G),this.router=m(F),this.showPassword=!1,this.loginForm=this.formBuilder.group({email:new S("",C.required),password:new S("",C.required)}),this.formSubmitted=k()}togglePasswordVisibility(){this.showPassword=!this.showPassword}onSubmit(){if(this.loginForm.invalid)return;let i=this.loginForm.getRawValue();this.formSubmitted.emit(i),this.login(i)}login(i){this.authService.login(i).then(e=>{e.isValid&&this.router.navigate(["/admin"],{state:{user:e.record}}).then(()=>{let o=e.record;this.toastrService.success(` Bienvenue ${o.name?o.name:o.email}!`,"Connexion",{closeButton:!0,progressAnimation:"decreasing",progressBar:!0})})}).catch(e=>{this.toastrService.error(" Une erreur s'est produite, v\xE9rifier votre connexion ou vos identifiants !","Connexion",{closeButton:!0,progressAnimation:"decreasing",progressBar:!0})})}ngOnInit(){let i=localStorage.getItem("pocketbase_auth");if(i){let{token:e}=JSON.parse(i);e?(this.authService.setToken(e),this.authService.isAuthenticated()?console.log("Connected to PocketBase with valid token"):console.log("Token is invalid or expired")):console.log("No token found")}}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=_({type:t,selectors:[["app-auth"]],outputs:{formSubmitted:"formSubmitted"},standalone:!0,features:[A],decls:26,vars:7,consts:[[1,"flex","min-h-full"],[1,"card","bg-ui","tls-shadow-md","m-auto","h-fit","w-full","max-w-sm","p-1",3,"ngSubmit","formGroup"],[1,"p-8"],[1,"text-title","mb-1","text-xl","font-semibold"],[1,"bg-white",3,"routerLink"],["src","./assets/logo/logo.png","alt","logo",1,"object-cover","h-full","w-full","aspect-[3/2]","bg-white"],[1,"text-2xl","font-ubuntu","font-bold","uppercase"],[1,"space-y-6","my-8"],[1,"field","flex-col","flex"],["for","email2",1,"text-title","text-sm"],["formControlName","email","type","email","required","","name","email2","id","email2",1,"input","sz-md","variant-mixed","min-w-full"],[1,"field"],[1,"flex","justify-between"],["for","pwd",1,"text-title","text-sm"],[1,"link","intent-info","variant-ghost","text-sm",3,"routerLink"],[1,"relative","flex","items-center"],["formControlName","password","required","","name","pwd","id","pwd",1,"input","sz-md","variant-mixed","w-full",3,"type"],["xmlns","http://www.w3.org/2000/svg","fill","#bbb","stroke","#bbb","viewBox","0 0 24 24","stroke-width","1.5",1,"w-4","h-4","absolute","right-4","cursor-pointer"],["type","submit",1,"btn","variant-primary","sz-md","w-full"],["xmlns","http://www.w3.org/2000/svg","fill","#bbb","stroke","#bbb","viewBox","0 0 24 24","stroke-width","1.5",1,"w-4","h-4","absolute","right-4","cursor-pointer",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"],["xmlns","http://www.w3.org/2000/svg","fill","#bbb","stroke","#bbb","viewBox","0 0 128 128",1,"w-4","h-4","absolute","right-4","cursor-pointer",3,"click"],["d","M64 104C22.127 104 1.367 67.496.504 65.943a4 4 0 0 1 0-3.887C1.367 60.504 22.127 24 64 24s62.633 36.504 63.496 38.057a4 4 0 0 1 0 3.887C126.633 67.496 105.873 104 64 104zM8.707 63.994C13.465 71.205 32.146 96 64 96c31.955 0 50.553-24.775 55.293-31.994C114.535 56.795 95.854 32 64 32 32.045 32 13.447 56.775 8.707 63.994zM64 88c-13.234 0-24-10.766-24-24s10.766-24 24-24 24 10.766 24 24-10.766 24-24 24zm0-40c-8.822 0-16 7.178-16 16s7.178 16 16 16 16-7.178 16-16-7.178-16-16-16z","data-original","#000000"]],template:function(e,o){e&1&&(n(0,"section",0)(1,"form",1),p("ngSubmit",function(){return o.onSubmit()}),n(2,"div",2)(3,"div")(4,"h1",3)(5,"a",4),a(6,"img",5),r()(),n(7,"p",6),l(8,"Connexion"),r()(),n(9,"div",7)(10,"div",8)(11,"label",9),l(12," Email"),r(),a(13,"input",10),r(),n(14,"div",11)(15,"div",12)(16,"label",13),l(17," Mot de passe"),r(),n(18,"a",14),l(19," Mot de passe oubli\xE9 ?"),r()(),n(20,"div",15),a(21,"input",16),y(22,K,2,0,":svg:svg",17)(23,Q,2,0),r()(),n(24,"button",18),l(25,"Se connecter"),r()()()()()),e&2&&(s(),u("formGroup",o.loginForm),s(4),u("routerLink",b(5,$)),s(13),u("routerLink",b(6,H)),s(3),u("type",o.showPassword?"text":"password"),s(),M(22,o.showPassword?22:23))},dependencies:[N,q,j,E,T,P,L,R,z]})}}return t})();var W=[{path:"",redirectTo:"",pathMatch:"full"},{path:"",title:"Authentification",component:O}],J=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275mod=d({type:t})}static{this.\u0275inj=c({imports:[x.forChild(W),x]})}}return t})();var ct=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275mod=d({type:t})}static{this.\u0275inj=c({imports:[V,J]})}}return t})();export{ct as AuthentificationModule};
